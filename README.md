# 数据挖掘 MCP 项目

基于 MCP (Model Context Protocol) 的智能数据分析系统，专注于工业测试数据挖掘和分析。

## 📋 项目概述

这是一个专业的数据挖掘工具，主要用于分析工业测试数据（振动测试、热真空测试等）。项目结合了AI智能分析和传统数据科学方法，提供图形化界面和丰富的数据可视化功能。

### 🎯 核心功能

- **智能数据分析**：基于GPT的AI助手，自动理解用户需求并执行相应分析
- **多类型分析**：支持统计分析、稳定性分析、趋势分析、异常检测、批次对比
- **可视化图表**：丰富的数据可视化功能，包括柱状图、散点图、饼图等
- **数据质量评估**：自动识别数据问题，提供清洗建议
- **批次对比**：支持多批次数据的对比分析，评估产品稳定性和改进效果

## 🏗️ 项目架构

```
DataMining-MCP/
│
├── 数据层 (Data Layer)
│   ├── scan.py              # 目录扫描工具
│   ├── csv_reader.py        # CSV文件读取和预处理
│   └── cache_utils.py       # 数据缓存管理
│
├── 分析层 (Analysis Layer)
│   ├── data_analyzer.py     # 核心数据分析引擎
│   └── format_fixer.py      # GPT响应格式修复工具
│
├── 调度层 (Dispatch Layer)
│   ├── gpt_dispatcher.py    # 工具调用调度器
│   └── gpt_api.py          # GPT API接口
│
├── 界面层 (UI Layer)
│   ├── enhanced_gui.py      # 增强版GUI界面
│   └── launcher.py         # 应用启动器
│
├── 配置层 (Config Layer)
│   ├── prompt.txt          # AI助手提示词配置
│   └── README_GUI.md       # GUI使用说明
│
├── 测试数据
│   └── data/               # 测试数据目录
│       ├── 测试数据正（公开）/
│       │   ├── 振动（公开）/
│       │   └── 热真空（公开）/
│       └── 测试数据鉴（公开）/
│
└── 测试脚本
    ├── test_*.py           # 各种功能测试脚本
    └── venv/              # Python虚拟环境
```

## 🚀 快速开始

### 环境要求

- Python 3.8+
- PyQt5
- pandas, numpy, scipy
- matplotlib, seaborn
- requests (用于GPT API调用)

### 安装依赖

```bash
# 安装核心依赖
pip install PyQt5 pandas numpy scipy matplotlib seaborn requests

# 或使用虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 启动应用

```bash
# 推荐方式：使用启动器
python launcher.py

# 或直接启动GUI
python enhanced_gui.py
```

## 💡 核心模块详解

### 1. 数据处理模块

#### `csv_reader.py`
- **功能**：智能CSV文件读取
- **特性**：
  - 自动编码检测（UTF-8, GBK, UTF-16, Latin1）
  - 重复表头行清理
  - 中文列名修复
  - 元数据提取

#### `scan.py`
- **功能**：目录和文件扫描
- **输出**：文件结构JSON格式，包含大小、修改时间等信息

#### `cache_utils.py`
- **功能**：分析结果缓存管理
- **优势**：避免重复计算，提高系统响应速度

### 2. 分析引擎

#### `data_analyzer.py`
核心分析引擎，提供多种分析方法：

- **基础统计分析**：均值、标准差、变异系数、分布分析
- **稳定性分析**：稳定性指数、最大变化率、稳定性评级
- **趋势分析**：时间序列趋势检测、相关性分析
- **异常检测**：基于IQR和Z-score的离群值检测
- **批次对比**：多批次数据的统计学比较分析

### 3. AI智能调度

#### `gpt_dispatcher.py`
- **功能**：解析AI指令，调度相应的分析工具
- **特性**：结果精简，确保GPT能够有效处理大数据量

#### `gpt_api.py`
- **功能**：GPT API接口封装
- **配置**：支持多种AI服务提供商

### 4. 用户界面

#### `enhanced_gui.py`
现代化的双面板设计：

**左侧：智能对话面板**
- 消息类型区分（用户/AI/工具/错误）
- 支持长文本自适应显示
- 快捷键支持（Ctrl+Enter发送）

**右侧：数据详情面板**
- 多标签页设计：统计数据、稳定性、趋势分析、异常检测、批次对比
- 实时数据可视化图表
- 数据导出功能

## 📊 分析能力详解

### 统计分析
```python
# 提供的统计指标
- 均值 (Mean)
- 标准差 (Standard Deviation)  
- 变异系数 (Coefficient of Variation)
- 最小值/最大值 (Min/Max)
- 分位数 (Percentiles)
```

### 稳定性分析
```python
# 稳定性评估体系
- 稳定性指数：基于变异系数的综合评分
- 最大变化率：数据波动的最大幅度
- 稳定性评级：优秀/良好/一般/较差
```

### 批次对比分析
```python
# 对比维度
- 均值变化：批次间平均水平的变化
- 稳定性对比：稳定性指标的改善情况
- 统计显著性：T检验验证差异显著性
- 改进评估：显著改善/稳定性改善/数值改善/需要关注
```

## 🎨 使用示例

### 单批次分析
```
用户输入："全面分析第3批次数据"
系统响应：
- 调用data_analysis工具，analysis_type="comprehensive"
- 自动识别文件路径：XXX-254-31Z01-03...csv
- 提供统计、稳定性、趋势、异常检测的完整分析
```

### 批次对比
```
用户输入："第2批次和第5批次稳定性对比"
系统响应：
- 调用batch_comparison工具
- 对比两批次的关键指标
- 提供改进建议和注意事项
```

### 可视化图表
系统会根据分析类型自动生成相应图表：
- 统计数据：均值、标准差、变异系数对比图
- 稳定性：稳定性指数柱状图
- 趋势分析：相关系数和变化率图表
- 异常检测：异常值分布图
- 批次对比：变化百分比和显著性分析图

## 🔧 配置说明

### GPT配置
在`gpt_api.py`中配置AI服务：
```python
# 支持多种AI服务
- OpenAI GPT
- Azure OpenAI
- 其他兼容服务
```

### 提示词配置
`prompt.txt`文件包含AI助手的行为配置：
- 工具调用格式规范
- 分析类型定义
- 输出格式要求

## 📈 数据支持

### 支持的数据类型
- **振动测试数据**：随机振动试验记录
- **热真空测试数据**：热循环和真空环境测试
- **对比数据**：多批次测试结果对比

### 数据格式要求
- CSV格式，支持中文编码
- 包含时间序列信息（可选）
- 数值型测试指标列

## 🛠️ 扩展开发

### 添加新的分析方法
1. 在`data_analyzer.py`中添加新方法
2. 在`gpt_dispatcher.py`中注册工具调用
3. 更新`prompt.txt`中的工具说明

### 自定义可视化
1. 在`enhanced_gui.py`的PlotCanvas类中添加新图表类型
2. 实现相应的绘制方法
3. 更新图表类型选择器

## 🔍 故障排除

### 常见问题
1. **编码错误**：确保CSV文件使用支持的编码格式
2. **内存不足**：对于大数据文件，系统会自动采样处理
3. **AI响应异常**：检查网络连接和API配置

### 日志和调试
- 控制台输出包含详细的错误信息
- 数据处理过程中的异常会被捕获并显示
- GUI界面提供实时状态指示


---
