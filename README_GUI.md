# MCP 智能数据分析助手 - 增强版界面

## 🚀 功能特色

**双面板设计**：左侧AI智能对话 + 右侧精确数据展示

## 📦 依赖安装

新增的可视化功能需要额外安装matplotlib和seaborn：

```bash
pip install matplotlib seaborn
```

或者如果有requirements.txt文件：
```bash
pip install -r requirements.txt
```

## 🎯 启动方式

### 方式一：使用启动器（推荐）
```bash
python launcher.py
```

### 方式二：直接启动
```bash
python enhanced_gui.py
```

## ✨ 界面特性

### 💬 左侧聊天面板
- **智能对话界面**
  - 消息类型区分（用户/AI/工具/错误）
  - 时间戳显示
  - 滚动历史记录
  - 支持Ctrl+Enter快捷发送
  - **长文本自适应显示**：AI回答自动调整高度，支持滚动

- **输入区域**
  - 多行文本输入
  - 清空/发送按钮
  - 智能提示

### 📊 右侧数据面板
- **统计数据标签页**
  - 均值、标准差、最值、变异系数
  - 表格形式清晰展示

- **稳定性标签页**
  - 稳定性评级
  - 稳定性指数
  - 最大变化率

- **趋势分析标签页**
  - 趋势方向和强度
  - 相关系数
  - 相对变化百分比

- **异常检测标签页**
  - 异常值数量和比例
  - 异常程度分析

- **批次对比标签页**
  - 两批次均值对比
  - 变化百分比
  - 稳定性对比结果
  - 统计显著性检验
  - 改进情况评估

- **可视化图表标签页** ✨ 新增功能
  - 统计数据图表：均值、标准差、变异系数对比
  - 稳定性图表：稳定性指数和最大变化率
  - 趋势分析图表：相关系数和相对变化
  - 异常检测图表：异常值数量和比例分布
  - 批次对比图表：变化百分比和显著性分析
  - 支持图表类型自动选择和手动切换
  - 实时数据可视化，与分析结果同步更新

### 🔧 功能特性
- **实时数据更新**：分析完成后自动更新右侧面板
- **智能标签页切换**：根据分析类型自动切换到对应标签页
- **长文本自适应显示**：AI回答支持滚动显示，不会被截断
- **数据导出**：支持将分析结果导出为JSON文件
- **智能清理**：新分析会自动清空旧数据
- **多分析类型支持**：全面分析、稳定性分析、趋势分析、异常检测、批次对比
- **可视化图表** ✨ 新增：
  - 智能图表类型识别，自动生成合适的可视化图表
  - 支持多种图表：柱状图、散点图、饼图等
  - 图表与数据表格同步更新
  - 支持手动切换图表类型
  - 中文字体支持，美化图表样式

## 🎨 界面主题

### 色彩方案
- **主色调**：现代蓝紫渐变
- **消息区分**：
  - 用户消息：蓝色边框
  - AI回复：绿色边框
  - 工具结果：橙色边框
  - 错误信息：红色边框

### 字体设计
- **主要字体**：微软雅黑
- **大小层次**：标题14px，正文11px，小字9px
- **粗细搭配**：标题加粗，正文常规

## 🔧 使用技巧

### 快速分析示例
```
单批次分析：
- "全面分析第3批次数据"
- "分析第五批次数据的稳定性"
- "第1批次数据趋势评价"
- "检测第2批次异常值"

批次对比：
- "第2批次和第5批次稳定性对比"
- "比较第1批次和第3批次的性能"
- "分析第4批次相对第6批次的改进"
```

### 数据分析类型
- **全面分析**：统计+稳定性+趋势+异常检测，右侧显示所有数据
- **稳定性分析**：专注稳定性评估，右侧显示稳定性标签页
- **趋势分析**：时间序列趋势检测，右侧显示趋势标签页
- **异常检测**：离群值识别，右侧显示异常检测标签页
- **批次对比**：两批次数据对比分析，右侧显示批次对比标签页

## 🛠️ 技术特性

### 智能数据面板
- **自动识别分析类型**：根据结果自动显示对应标签页
- **数据自动清理**：新分析会清空旧数据
- **多格式支持**：支持综合分析和单一分析结果

### 智能格式修复
- 自动修复GPT返回格式错误
- 文本到JSON的智能转换
- 错误兜底处理

### 数据精简优化
- 大数据量自动精简（90%压缩）
- 保留关键分析信息
- 确保GPT可有效处理

## 📊 状态指示
- **实时状态显示**
  - 🟢 就绪
  - 🟡 思考中
  - 🔵 工作中  
  - 🔴 错误

## 🎯 常用操作示例

### 单批次分析
```
输入：分析第五批次数据的稳定性
结果：
- 左侧：AI提供稳定性评价和建议（长文本自动滚动显示）
- 右侧：自动切换到稳定性标签页，显示具体指标数据
```

### 全面分析
```
输入：全面分析第一批次数据
结果：
- 左侧：AI综合分析报告
- 右侧：所有标签页显示完整数据
```

### 批次对比
```
输入：第2批次和第5批次稳定性对比  
结果：
- 左侧：AI对比分析和改进建议（长文本自动滚动显示）
- 右侧：自动切换到批次对比标签页，显示详细对比数据
  * 各指标的两批次均值
  * 变化百分比和稳定性对比
  * 统计显著性和改进情况
```

## 🔍 故障排除

### 右侧面板不更新
- 确认分析已完成（状态显示为"就绪"）
- 检查是否出现错误提示
- 尝试重新发送分析请求

### 界面无响应
- 检查网络连接
- 重启应用程序
- 查看状态指示器

### 分析结果异常
- 确认数据文件存在
- 检查文件格式正确性
- 查看错误消息提示

## 📞 技术支持

如遇问题，请检查：
1. Python环境和依赖包
2. 数据文件路径正确性
3. GPT API配置状态
4. 控制台错误日志信息

---

**享受智能分析与精确数据并存的现代化体验！** 🚀